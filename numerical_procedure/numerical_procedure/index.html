<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerical Implementation · WAVI.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="WAVI.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WAVI.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/planar_1D_flow/">First example: one-dimensional planar flow</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/overview/">Overview</a></li><li><a class="tocitem" href="../../physics/governing_equations/">Governing Equations</a></li><li><a class="tocitem" href="../../physics/melting/">Melt Rates</a></li></ul></li><li class="is-active"><a class="tocitem" href>Numerical Implementation</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Problem-Reduction"><span>Problem Reduction</span></a></li><li class="toplevel"><a class="tocitem" href="#Velocity-Solve"><span>Velocity Solve</span></a></li><li class="toplevel"><a class="tocitem" href="#Timestepping"><span>Timestepping</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">WAVI Setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../data_structure/overview/">Overview</a></li><li><a class="tocitem" href="../../data_structure/simulations/">Simulations</a></li><li><a class="tocitem" href="../../data_structure/model/">Models</a></li><li><a class="tocitem" href="../../data_structure/timestepping_params/">Timestepping Parameters</a></li><li><a class="tocitem" href="../../data_structure/output_writing/">Output Writing</a></li><li><a class="tocitem" href="../../data_structure/grid/">Grid</a></li><li><a class="tocitem" href="../../data_structure/solver_parameters/">Solver Parameters</a></li><li><a class="tocitem" href="../../data_structure/params/">Physical Paramters</a></li><li><a class="tocitem" href="../../data_structure/initial_conditions/">Initial Conditions</a></li><li><a class="tocitem" href="../../data_structure/fields/">Fields</a></li><li><a class="tocitem" href="../../data_structure/melt_rate_models/">Melt Rate Models</a></li></ul></li><li><a class="tocitem" href="../../mitgcm_coupling/">MITgcm coupling</a></li><li><a class="tocitem" href="../../contact/">Contact us</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Numerical Implementation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Numerical Implementation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RJArthern/WAVI.jl/blob/main/docs/src/numerical_procedure/numerical_procedure.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Numerical-Grid"><a class="docs-heading-anchor" href="#Numerical-Grid">Numerical Grid</a><a id="Numerical-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Grid" title="Permalink"></a></h1><p>WAVI.jl solves the <a href="../../physics/governing_equations/">governing equations</a> on a rectangular grid, with <span>$n_x$</span> grid cells in the <span>$x$</span> direction and <span>$n_y$</span> grid cells in the <span>$y$</span> direction. Ice thickness values <span>$h$</span> are defined at the cell centers (see figure) of grid cells, while velocity components <span>$\bar{u}$</span> and <span>$\bar{v}$</span> are defined along grid cell edges, and shear strain rates <span>$c = (\partial u /\partial y + \partial v / \partial x)/2$</span> are stored at grid corners.</p><center><img src="https://raw.githubusercontent.com/RJArthern/WAVI.jl/build-docs/docs/src/assets/grid-schematic.jpg" alt="" title="" width="400" height="400" />
<figcaption>Figure 1: Locations within grid cells that ice thickness $h$, velocity components $u$ and $v$, and shear strain rates $c = (\partial u /\partial y + \partial v / \partial x)/2$ are stored. </figcaption></center><p>The set of all such points at which the ice thickness is stored defines the <span>$h$</span>-grid. The <span>$u$</span>-grid, <span>$v$</span>-grid, and <span>$c$</span>-grid are defined analagously. Various different quantities are also stored on each of these grids, and used as part of the solution (see <a href="../../data_structure/fields/">Fields</a> for more information).</p><p>Three dimensional fields used in the governing equations (e.g. viscosity) are stored <span>$h$</span>-grid points, extrapolated into the <span>$z$</span> direction. This grid is referred to as the <span>$\sigma$</span>-grid.</p><h1 id="Problem-Reduction"><a class="docs-heading-anchor" href="#Problem-Reduction">Problem Reduction</a><a id="Problem-Reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Reduction" title="Permalink"></a></h1><p>This section contains brief details of the procedure by which the momentum balance equations <a href="../../physics/governing_equations/">governing equations</a>(2)–(4) are reduced to a non-linear equation for the depth average velocity <span>$\bar{\mathbf{u}}$</span>. For full details, refer to <a href="../../references/#Arthern2015">Robert J Arthern, Richard CA Hindmarsh, C Rosie Williams (2015)</a>.</p><p>To make progress in solving the <a href="../../physics/governing_equations/">governing equations</a>, horizontal gradients in vertical velocity are neglected and vertical shear stresses are assumed to vary linearly with depth. Then, if the ice thickness <span>$h$</span>, surface elevation <span>$h$</span>, ice stiffness, basal stresses and horizontal stress components are known, the depth integrated viscosity </p><p class="math-container">\[\begin{equation}
    \bar{\eta} = \frac{1}{h}\int_{s - h}^{h} \eta~\mathrm{d}z
\end{equation}\]</p><p>can be computed numerically. Here <span>$\eta$</span> is the ice viscosity (equation (4) in the<a href="../../physics/governing_equations/">governing equations</a>).</p><p>After depth integrating the approximation to the horizonal stress components, and using the Robin boundary condition (equation (7)), the basal velocity components – and thus basal stress terms – can be expressed in terms of the depth averaged velocity components. The basal stress components can then be eliminated from  <a href="../../physics/governing_equations/">governing equations</a>(2)–(3), which can therefore be expressed as a non-linear problem for <span>$\bar{\mathbf{u}}$</span>, the depth averaged velocity:</p><p class="math-container">\[\begin{equation}
\mathcal{L}(\bar{\mathbf{u}}) \bar{\mathbf{u}} = \mathbf{f}
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{equation}\label{E:operator_problem}
\mathcal{L} = \begin{pmatrix} 
\partial_{x} 4 \bar{\eta} h \partial_{x} + \partial_{y}  \bar{\eta} h \partial_{y} - \beta_{\text{eff}} &amp; \partial_{x} 2 \bar{\eta} h \partial_{y} + \partial_{y}  \bar{\eta} h \partial_{x} \\
\partial_{x} \bar{\eta} h \partial_{y} + \partial_{y} 2  \bar{\eta} h \partial_{x} &amp; \partial_x  \bar{\eta} h \partial_x + \partial_y 4 \bar{\eta} h \partial_y - \beta_{\text{eff}} 
\end{pmatrix}
\end{equation}\]</p><p>with <span>$\beta_{\text{eff}}$</span> an effective drag coefficient (see equation (12) in <a href="../../references/#Arthern2015">Robert J Arthern, Richard CA Hindmarsh, C Rosie Williams (2015)</a>).</p><h1 id="Velocity-Solve"><a class="docs-heading-anchor" href="#Velocity-Solve">Velocity Solve</a><a id="Velocity-Solve-1"></a><a class="docs-heading-anchor-permalink" href="#Velocity-Solve" title="Permalink"></a></h1><p>This section described very briefly the steps involved in the procedure by which the non-linear elliptic problem for the velocity (equation \eqref{E:operator_problem}) is solved in <code>WAVI.jl</code>. Again, for full details, refer to <a href="../../references/#Arthern2015">Robert J Arthern, Richard CA Hindmarsh, C Rosie Williams (2015)</a>.</p><ul><li>The problem \eqref{E:operator_problem} is discretized with a finite difference approximation. Details of the discretization are included in the appendix of <a href="../../references/#Arthern2015">Robert J Arthern, Richard CA Hindmarsh, C Rosie Williams (2015)</a>. </li><li>The resulting problem is expressed as a symmetric saddle point problem. </li><li>The saddle point problem is expressed as two distinct problems. The first is solver iteratively using a <a href="https://en.wikipedia.org/wiki/Biconjugate_gradient_stabilized_method">BiCGSTAB method</a></li><li>The second problem is solved using an iterative method, leveraging an [LU-factorization] of the mass matrix in the problem.</li></ul><h1 id="Timestepping"><a class="docs-heading-anchor" href="#Timestepping">Timestepping</a><a id="Timestepping-1"></a><a class="docs-heading-anchor-permalink" href="#Timestepping" title="Permalink"></a></h1><p>If the system is to be solved forwards in time, the velocity must be solved simultanously with the surface elevation (i.e. equations (2)–(4) and (8)) must be solved simultanously. The procedure is largely as described above for the velocity components, but the problem is preconditioned using an iterative approach inspired by <a href="../../references/#Vasilyev2005">Oleg V Vasilyev, Nicholas K-R Kevlahan (2005)</a> to improve computational speed. Once the velocities have been solved for, the surface elecation is updated using a simple Euler scheme.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../physics/melting/">« Melt Rates</a><a class="docs-footer-nextpage" href="../../data_structure/overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 3 May 2023 19:39">Wednesday 3 May 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
