<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Two-dimensional flow on a bumpy bed · WAVI.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="WAVI.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WAVI.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../planar_1D_flow/">First example: one-dimensional planar flow</a></li><li><a class="tocitem" href="../mismip_plus/">MISMIP+ part one: grounding lines on overdeepened bed</a></li><li><a class="tocitem" href="../mismip_plus_retreat/">MISMIP+ part two: retreat experiments</a></li><li class="is-active"><a class="tocitem" href>Two-dimensional flow on a bumpy bed</a><ul class="internal"><li><a class="tocitem" href="#Install-dependencies"><span>Install dependencies</span></a></li><li><a class="tocitem" href="#Basal-Topography"><span>Basal Topography</span></a></li><li><a class="tocitem" href="#Model-Instantiation-and-Initial-Conditions"><span>Model Instantiation and Initial Conditions</span></a></li><li><a class="tocitem" href="#Determining-the-velocity"><span>Determining the velocity</span></a></li><li><a class="tocitem" href="#Different-lengthscales"><span>Different lengthscales</span></a></li></ul></li><li><a class="tocitem" href="../melt_parametrizations/">Melt rate parametrizations</a></li><li><a class="tocitem" href="../stochastic_forcing/">Ice sheet retreat under stochastic forcing</a></li><li><a class="tocitem" href="../WAIS/">Real world: West Antarctic Ice Sheet</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/overview/">Overview</a></li><li><a class="tocitem" href="../../physics/governing_equations/">Governing Equations</a></li><li><a class="tocitem" href="../../physics/melting/">Basal Melt Rate Parametrizations</a></li></ul></li><li><a class="tocitem" href="../../numerical_procedure/numerical_procedure/">Numerical Implementation</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../data_structure/overview/">Overview</a></li><li><a class="tocitem" href="../../data_structure/simulations/">Simulations</a></li><li><a class="tocitem" href="../../data_structure/model/">Models</a></li><li><a class="tocitem" href="../../data_structure/timestepping_params/">Timestepping Parameters</a></li><li><a class="tocitem" href="../../data_structure/output_writing/">Output Writing</a></li><li><a class="tocitem" href="../../data_structure/grid/">Grid</a></li><li><a class="tocitem" href="../../data_structure/solver_parameters/">Solver Parameters</a></li><li><a class="tocitem" href="../../data_structure/params/">Physical Parameters</a></li><li><a class="tocitem" href="../../data_structure/initial_conditions/">Initial Conditions</a></li><li><a class="tocitem" href="../../data_structure/fields/">Fields</a></li><li><a class="tocitem" href="../../data_structure/melt_rate_models/">Basal Melt Rate Models</a></li></ul></li><li><a class="tocitem" href="../../mitgcm_coupling/">MITgcm coupling</a></li><li><a class="tocitem" href="../../contributing/">Contributors guide</a></li><li><a class="tocitem" href="../../contact/">Contact us</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Two-dimensional flow on a bumpy bed</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Two-dimensional flow on a bumpy bed</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RJArthern/WAVI.jl/blob/main/docs/src/examples/bumpy_bed.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Ice-Flow-over-a-Bumpy-Bed"><a class="docs-heading-anchor" href="#Ice-Flow-over-a-Bumpy-Bed">Ice Flow over a Bumpy Bed</a><a id="Ice-Flow-over-a-Bumpy-Bed-1"></a><a class="docs-heading-anchor-permalink" href="#Ice-Flow-over-a-Bumpy-Bed" title="Permalink"></a></h1><p>This is a good first two dimensional example: flow down a plane with a series of bumps superimposed. We consider how the size of the bump affects the flow speed. This example is similar in spirit to Experiment A in the Ice Sheet Model Intercomparison Exercise - Higher Order Model (ISMIP-HOM): doi: 10.5194/tc-2-95-2008</p><p>This example demonstrates how to     * use WAVI.jl in two horizontal spatial dimensions with arbitrary bed shapes     * how to interact with Grid objects.</p><h2 id="Install-dependencies"><a class="docs-heading-anchor" href="#Install-dependencies">Install dependencies</a><a id="Install-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Install-dependencies" title="Permalink"></a></h2><p>First let&#39;s make sure we have all required packages installed.</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(PackageSpec(url=&quot;https://github.com/RJArthern/WAVI.jl.git&quot;, rev = &quot;main&quot;))
Pkg.add(`Plots`)
using WAVI, Plots</code></pre><h2 id="Basal-Topography"><a class="docs-heading-anchor" href="#Basal-Topography">Basal Topography</a><a id="Basal-Topography-1"></a><a class="docs-heading-anchor-permalink" href="#Basal-Topography" title="Permalink"></a></h2><p>Following ISMIP-HOM, we&#39;ll consider a bed with a series of sinusoidal oscillations with an amplitude of 500m: $ z_b(x,y) = -x \tan \alpha + 500 \sin (\omega x) \sin(\omega y) $ Here <span>$L$</span> is the lengthscale of the domain, <span>$\alpha$</span> is the net slope of the plane, and <span>$\omega = 2\pi / L$</span> is the frequency of the bumps. We can express this bed analytically, so we write it as a function and pass it to WAVI that way</p><pre><code class="language-julia hljs">z_b(x,y; α, ω) = -x * tand(α) + 500sin(ω*x)*sin(ω*y)</code></pre><p>It&#39;s useful to define our model grid here:</p><pre><code class="language-julia hljs">grid_L(; L, nx = 80,ny = 80) = Grid(nx = nx, ny = ny, dx = L/nx, dy = L/ny, y0 = 0.0, x0 = 0.0);</code></pre><p>Note that <code>grid_L</code> is a function, it takes a lengthscale <code>L</code> which defines the lengthscale of the domain in both <span>$x$</span> and <span>$y$</span> directions (the grid is square) and optional arguments <code>nx</code> and <code>ny</code>, which set the number of grid points, with default value of 80 for both.</p><p>Let&#39;s choose a domain of 80km with 80 grid points</p><pre><code class="language-julia hljs">L = 80000.
grid80 = grid_L(L = L)</code></pre><p>This grid object contains information about the location of grid points. We use this to construct an array defining the bed from the bed function <code>z_b</code> defined earlier (we don&#39;t need this step for the solver, but we do to visualize!). We&#39;ll choose the period of the bumps so that we have one peak and one trough in both directions (via the <code>ω</code> parameter)</p><pre><code class="language-julia hljs">z_b80 = z_b.(grid80.xxh,grid80.yyh; α = 0.5, ω = 2π/L );
plt = Plots.heatmap(grid80.xxh[:,1]/1e3, grid80.yyh[1,:]/1e3, z_b80, 
                        xlabel = &quot;x (km)&quot;, 
                        ylabel = &quot;y (km)&quot;,
                        colorbar_title = &quot;bed depth (m)&quot;)
plot!(size = (800,800))</code></pre><center><img src="https://raw.githubusercontent.com/RJArthern/WAVI.jl/build-docs/docs/src/assets/example-plots//bumpy//bed.png" alt="" title="" width="600" height="600" /></center><h2 id="Model-Instantiation-and-Initial-Conditions"><a class="docs-heading-anchor" href="#Model-Instantiation-and-Initial-Conditions">Model Instantiation and Initial Conditions</a><a id="Model-Instantiation-and-Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Instantiation-and-Initial-Conditions" title="Permalink"></a></h2><p>In the ISMIP-HOM comparison, the main test is velocity along the line <span>$y = L/4$</span>, for various different values of <span>$L$</span>. Before we do that, lets look at the velocity for the example we started above with <span>$L = 80$</span>km. </p><p>To begin, we create an <code>InitialConditions</code> object to prescribe the ice thickness of 1000m everywhere</p><pre><code class="language-julia hljs">initial_conditions = InitialConditions(initial_thickness = 1000. .* ones(grid80.nx, grid80.ny))</code></pre><p>Now we can build our model</p><pre><code class="language-julia hljs">model80 = Model(grid = grid80, 
            bed_elevation = z_b80,
            initial_conditions = initial_conditions)</code></pre><h2 id="Determining-the-velocity"><a class="docs-heading-anchor" href="#Determining-the-velocity">Determining the velocity</a><a id="Determining-the-velocity-1"></a><a class="docs-heading-anchor-permalink" href="#Determining-the-velocity" title="Permalink"></a></h2><p>To bring the velocity in line with the ice thickness, we use the <code>update_state!</code> function:</p><pre><code class="language-julia hljs">update_state!(model80)</code></pre><p>Now we can look at the velocity:</p><pre><code class="language-julia hljs">Plots.heatmap(model80.grid.xxh[:,1]/1e3, model80.grid.yyh[1,:]/1e3, model80.fields.gh.u&#39;, 
                        xlabel = &quot;x (km)&quot;, 
                        ylabel = &quot;y (km)&quot;,
                        colorbar_title = &quot;ice velocity in x-direction (m/yr)&quot;)
plot!(size = (800,600))</code></pre><center><img src="https://raw.githubusercontent.com/RJArthern/WAVI.jl/build-docs/docs/src/assets/example-plots//bumpy//velocity_L80.png" alt="" title="" width="600" height="600" /></center><h2 id="Different-lengthscales"><a class="docs-heading-anchor" href="#Different-lengthscales">Different lengthscales</a><a id="Different-lengthscales-1"></a><a class="docs-heading-anchor-permalink" href="#Different-lengthscales" title="Permalink"></a></h2><p>Now let&#39;s look at how the velocity along a flowline changes with the lengthscale of the domain <code>L</code>. Note that the bumps stay the same size, so as <code>L</code> increases, the aspect ratio of the bumps reduces, and we might expect they influence the flow less.</p><p>First we define the <code>L</code> values we&#39;re interested in</p><pre><code class="language-julia hljs">L_values =  [160, 80, 40, 20, 10, 5]*1.0e3;</code></pre><p>We loop over these values and store the info:</p><pre><code class="language-julia hljs">U_flowline = zeros(80, length(L_values));
grid_flowline = zeros(80, length(L_values)); # initialize storage of the the velocity (U_flowline) and x-coordinates (grid_flowline)
for (count,L) in enumerate(L_values) ;
    gridL = grid_L(L = L); #make the grid with this value of L
    z_bL = z_b.(gridL.xxh,gridL.yyh; α = 0.5, ω = 2π/L ); #make the bed with this grid
    initial_conditions = InitialConditions(initial_thickness = 1000. .* ones(80, 80)); #initial thickness of 1000m everywhere
    model = Model(grid = gridL, 
                bed_elevation = z_bL,
                initial_conditions = initial_conditions);  #build model
    update_state!(model); #get the velocity assoiciated with geometry
    grid_flowline[:, count] .= model.grid.xxh[:, round(Int, gridL.nx/4)]; #extract coordinates along line
    U_flowline[:,count] .= model.fields.gh.u[:, round(Int, gridL.nx/4)]; #get velocity along line
end</code></pre><p>And make the plot:</p><pre><code class="language-julia hljs">p = plot()
#first normalize the co-ordinates
normalized_grid_flowline = zeros(size(grid_flowline))
for i = 1:(size(L_values)[1])
    plot!(grid_flowline[:,i]./L_values[i]/1e3,
    U_flowline[:,i], 
    framestyle = :box, 
    xlabel = &quot;x/L (km)&quot;, 
    ylabel = &quot;horizontal velocity (m/yr)&quot;,
    label = L_values[i])
end
display(p)
plot!(size = (1000,550))</code></pre><center><img src="https://raw.githubusercontent.com/RJArthern/WAVI.jl/build-docs/docs/src/assets/example-plots//bumpy//velocity_diffL.png" alt="" title="" width="600" height="600" /></center><p>As expected, when the bumps have a smaller aspect ratio (smaller <code>L</code>) the flow speed is smaller.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mismip_plus_retreat/">« MISMIP+ part two: retreat experiments</a><a class="docs-footer-nextpage" href="../melt_parametrizations/">Melt rate parametrizations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 8 March 2024 18:06">Friday 8 March 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
